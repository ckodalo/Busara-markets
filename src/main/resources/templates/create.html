<div class="max-w-2xl mx-auto p-4 sm:p-6 lg:p-8">
  <h1 class="font-semibold text-2xl text-gray-800 leading-tight">Create Market</h1>
  <form th:action="@{/markets/create}" method="post" class="space-y-4">
    <!-- Title Field -->
    <div>
      <label for="title" class="block font-medium text-sm text-gray-700">Title:</label>
      <input type="text" class="block w-full border-gray-300 focus:border-indigo-500 focus:ring-indigo-500 rounded-md shadow-sm" id="title" name="title" required>
    </div>
    <!-- Description Field -->
    <div>
      <label for="description" class="block font-medium text-sm text-gray-700">Description:</label>
      <textarea class="block w-full border-gray-300 focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50 rounded-md shadow-sm" id="description" name="description" rows="3" required></textarea>
    </div>
    <!-- Market Type Field -->
    <div>
      <label for="marketType" class="block font-medium text-sm text-gray-700">Market Type:</label>
      <select id="marketType" name="marketType" class="block w-full border-gray-300 focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50 rounded-md shadow-sm" required>
        <option value="" disabled selected>Select Market Type</option>
        <option value="YesNo">Yes or No</option>
        <option value="MultipleChoice">Multiple Choice</option>
        <option value="Poll">Poll</option>
      </select>
    </div>
    <!-- Securities Section -->
    <div id="securities" class="space-y-2">
      <!-- Yes/No Market: No securities needed -->
      <div id="yesNoSection" class="hidden">
<!--        <p class="text-sm text-gray-700">Yes/No market doesn't require securities.</p>-->
        <input type="hidden" value="yes" name="security">
        <input type="hidden" value="no" name="security">
      </div>
      <!-- MultipleChoice and Poll Markets: Securities needed -->
      <div id="multipleChoicePollSection" class="hidden">
        <div class="security-input flex items-center space-x-2">
          <label for="security1" class="block font-medium text-sm text-gray-700">Security:</label>
          <input type="text" class="border-gray-300 focus:border-indigo-500 focus:ring-indigo-500 rounded-md shadow-sm flex-1" id="security1" name="security" required>
        </div>
        <button type="button" id="addSecurity" class="mt-2 inline-flex items-center px-3 py-1 bg-gray-600 border border-transparent rounded-md font-semibold text-xs text-white uppercase tracking-widest hover:bg-gray-700 focus:bg-gray-700 active:bg-gray-800 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2 transition ease-in-out duration-150">Add Security</button>
      </div>
    </div>
    <!-- Submit Button -->
    <button type="submit" class="mt-4 inline-flex items-center px-4 py-2 bg-gray-800 border border-transparent rounded-md font-semibold text-xs text-white uppercase tracking-widest hover:bg-gray-700 focus:bg-gray-700 active:bg-gray-900 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2 transition ease-in-out duration-150">Add Market</button>
  </form>
</div>

<script>
    document.getElementById('marketType').addEventListener('change', function() {
        var marketType = this.value;
        var yesNoSection = document.getElementById('yesNoSection');
        var multipleChoicePollSection = document.getElementById('multipleChoicePollSection');

        if (marketType === 'YesNo') {
            yesNoSection.classList.remove('hidden');
            multipleChoicePollSection.classList.add('hidden');
            // Remove all security inputs
            while (multipleChoicePollSection.firstChild) {
                multipleChoicePollSection.removeChild(multipleChoicePollSection.firstChild);
            }
        } else if (marketType === 'MultipleChoice' || marketType === 'Poll') {
            yesNoSection.classList.add('hidden');
            multipleChoicePollSection.classList.remove('hidden');
            addSecurityInput();
        }
    });

    document.getElementById('addSecurity').addEventListener('click', addSecurityInput);

    function addSecurityInput() {
        var securitiesDiv = document.getElementById('multipleChoicePollSection');
        var securityCount = securitiesDiv.getElementsByClassName('security-input').length + 1;

        var securityInput = document.createElement('div');
        securityInput.classList.add('security-input', 'flex', 'items-center', 'space-x-2');

        var label = document.createElement('label');
        label.setAttribute('for', 'security' + securityCount);
        label.classList.add('block', 'font-medium', 'text-sm', 'text-gray-700');
        label.innerText = 'Security:';

        var input = document.createElement('input');
        input.setAttribute('type', 'text');
        input.classList.add('border-gray-300', 'focus:border-indigo-500', 'focus:ring-indigo-500', 'rounded-md', 'shadow-sm', 'flex-1');
        input.setAttribute('id', 'security' + securityCount);
        input.setAttribute('name', 'security');
        input.setAttribute('required', '');

        var removeButton = document.createElement('button');
        removeButton.setAttribute('type', 'button');
        removeButton.classList.add('px-2', 'py-1', 'bg-red-500', 'text-white', 'rounded-md', 'hover:bg-red-600', 'focus:outline-none');
        removeButton.innerText = 'Remove';
        removeButton.addEventListener('click', function() {
            securitiesDiv.removeChild(securityInput);
        });

        securityInput.appendChild(label);
        securityInput.appendChild(input);
        securityInput.appendChild(removeButton);
        securitiesDiv.appendChild(securityInput);
    }
</script>



